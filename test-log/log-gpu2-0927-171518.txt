=== TRAIN START 2025Âπ¥ 09Êúà 27Êó• ÊòüÊúüÂÖ≠ 17:15:18 CST ===
CUDA_VISIBLE_DEVICES=2
/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
Using config: configs/cd4mt_medium.yaml
Found 1290 tracks.
sr=44100, min: 10, max: 600
Keeping 1289 of 1290 tracks
Data size: 26309
Use mixup rate of 0.0; Use SpecAug (T,F) of (0, 0); Use blurring effect or not False
| Audiostock Dataset Length:26309 | Epoch Length: 26309
Found 271 tracks.
sr=44100, min: 10, max: 600
Keeping 270 of 271 tracks
Data size: 5422
Use mixup rate of 0.0; Use SpecAug (T,F) of (0, 0); Use blurring effect or not False
| Audiostock Dataset Length:5422 | Epoch Length: 5422
Found 152 tracks.
sr=44100, min: 10, max: 600
Keeping 151 of 152 tracks
Data size: 3249
Use mixup rate of 0.0; Use SpecAug (T,F) of (0, 0); Use blurring effect or not False
| Audiostock Dataset Length:3249 | Epoch Length: 3249
Selected CUDA:0 (free ~23.2 GB)
/data1/yuchen/cd4mt/src/music2latent/music2latent
[Model] CM.UNet: params=150,610,371 (trainable=150,610,371), param_mem‚âà574.5 MB (dtype=torch.float32)
/data1/yuchen/cd4mt/test.py:237: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/data1/yuchen/cd4mt/test.py:243: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.float16):
Sanity check OK. loss=0.098456 (micro_bsz=8)
swanlab: swanlab version 0.6.10 is available!  Upgrade: `pip install -U swanlab`
swanlab: Tracking run with swanlab version 0.7.0-dev
swanlab: Run data will be saved locally in 
/data1/yuchen/cd4mt/swanlog/run-20250927_171628-iqt2ygnyu7p7ojbrhfsg2
swanlab: üëã Hi tlhey123,welcome to swanlab!
swanlab: Syncing run ct_unet_0927_171624 to the cloud
swanlab: üè† View project at https://swanlab.cn/@tlhey123/cd4mt
swanlab: üöÄ View run at 
https://swanlab.cn/@tlhey123/cd4mt/runs/iqt2ygnyu7p7ojbrhfsg2
/data1/yuchen/cd4mt/test.py:285: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.float16):
[train] epoch=0 step=0/206 loss=0.1332
[train] epoch=0 step=20/206 loss=0.0899
[train] epoch=0 step=40/206 loss=0.0740
[train] epoch=0 step=60/206 loss=0.0840
[train] epoch=0 step=80/206 loss=0.0814
swanlab: Error happened while training
swanlab: üè† View project at https://swanlab.cn/@tlhey123/cd4mt
swanlab: üöÄ View run at 
https://swanlab.cn/@tlhey123/cd4mt/runs/iqt2ygnyu7p7ojbrhfsg2
  File "/data1/yuchen/cd4mt/test.py", line 428, in <module>
  File "/data1/yuchen/cd4mt/test.py", line 276, in main
    model.train();
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1488, in _next_data
    return self._process_data(data, worker_id)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1550, in _process_data
    data.reraise()
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/_utils.py", line 750, in reraise
    raise exception
Caught AssertionError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data1/yuchen/cd4mt/ldm/data/multitrack_dataset.py", line 863, in __getitem__
    # Mix audio and fbank features by summing; ensure same length and proper alignment
  File "/data1/yuchen/cd4mt/ldm/data/multitrack_dataset.py", line 821, in get_mel_from_waveform
    y = y.float()
  File "/data1/yuchen/MusicLDM-Ext/src/utilities/audio/stft.py", line 177, in mel_spectrogram
    assert torch.max(y.data) <= 1, torch.max(y.data)
AssertionError: tensor(1.0088)

