=== TRAIN RESTART 2025年 09月 27日 星期六 17:37:04 CST ===
CUDA_VISIBLE_DEVICES=3
/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/cuda/__init__.py:789: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/torch/cuda/__init__.py:991: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 304: OS call failed or operation not supported on this OS (Triggered internally at /pytorch/c10/cuda/CUDAFunctions.cpp:109.)
  r = torch._C._cuda_getDeviceCount() if nvml_count < 0 else nvml_count
/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/joblib/_multiprocessing_helpers.py:44: UserWarning: [Errno 13] Permission denied.  joblib will operate in serial mode
  warnings.warn("%s.  joblib will operate in serial mode" % (e,))
Traceback (most recent call last):
  File "/data1/yuchen/cd4mt/test.py", line 35, in <module>
    from ldm.data.multitrack_datamodule import DataModuleFromConfig
  File "/data1/yuchen/cd4mt/ldm/data/multitrack_datamodule.py", line 5, in <module>
    from ldm.data.multitrack_dataset import AudiostockDataset, DS_10283_2325_Dataset, Audiostock_splited_Dataset, Slakh_Dataset, MultiSource_Slakh_Dataset
  File "/data1/yuchen/cd4mt/ldm/data/multitrack_dataset.py", line 17, in <module>
    import utilities.audio as Audio
  File "/data1/yuchen/MusicLDM-Ext/src/utilities/__init__.py", line 2, in <module>
    from .data import *
  File "/data1/yuchen/MusicLDM-Ext/src/utilities/data/__init__.py", line 1, in <module>
    from .dataset import Dataset
  File "/data1/yuchen/MusicLDM-Ext/src/utilities/data/dataset.py", line 17, in <module>
    import utilities.audio as Audio
  File "/data1/yuchen/MusicLDM-Ext/src/utilities/audio/__init__.py", line 2, in <module>
    from .stft import *
  File "/data1/yuchen/MusicLDM-Ext/src/utilities/audio/stft.py", line 5, in <module>
    from librosa.util import pad_center, tiny
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/lazy_loader/__init__.py", line 82, in __getattr__
    submod = importlib.import_module(submod_path)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/librosa/util/utils.py", line 1047, in <module>
    def _localmax(x, y):  # pragma: no cover
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/np/ufunc/decorators.py", line 201, in wrap
    guvec = GUVectorize(func, signature, **kwargs)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/np/ufunc/decorators.py", line 56, in __new__
    return imp(func, signature, identity=identity, cache=cache,
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/np/ufunc/gufunc.py", line 79, in __init__
    self.gufunc_builder = GUFuncBuilder(
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/np/ufunc/ufuncbuilder.py", line 355, in __init__
    self.nb_func = jit(_target='npyufunc', cache=cache)(py_func)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/core/decorators.py", line 227, in wrapper
    disp.enable_caching()
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/np/ufunc/ufuncbuilder.py", line 108, in enable_caching
    self.cache = FunctionCache(self.py_func)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/core/caching.py", line 687, in __init__
    self._impl = self._impl_class(py_func)
  File "/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/numba/core/caching.py", line 423, in __init__
    raise RuntimeError("cannot cache function %r: no locator available "
RuntimeError: cannot cache function '_localmax': no locator available for file '/home/yuchen/.local/share/mamba/envs/cdp10/lib/python3.10/site-packages/librosa/util/utils.py'
